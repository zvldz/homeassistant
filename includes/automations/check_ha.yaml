- alias: ha1_server_off
  # blackout
  #initial_state: true
  initial_state: false
  mode: parallel
  trigger:
    - platform: state
      entity_id: sensor.ha1_uptime
      to: "unavailable"
      for: "00:02:00"
    - platform: state
      entity_id: sensor.ha2_uptime
      to: "unavailable"
      for: "00:02:00"
    - platform: state
      entity_id: sensor.has_uptime
      to: "unavailable"
      for: "00:02:00"
    - platform: state
      entity_id: sensor.ha_fazenda_uptime
      to: "unavailable"
      for: "00:02:00"
#    - platform: state
#      entity_id: sensor.ha_off_uptime
#      to: "unavailable"
#      for: "00:02:00"
  action:
    - service: notify.send_message
      data:
        entity_id: notify.telegram_vtel
        message: "\U00002620 {{ states.sensor.date_time.state }} | {{ state_attr(trigger.entity_id, 'friendly_name') | replace(' Uptime', '') if trigger.entity_id is defined else 'Test' }} is not working"

- alias: ha1_server_on
  # blackout
  #initial_state: true
  initial_state: false
  mode: parallel
  trigger:
    - platform: state
      entity_id: sensor.ha1_uptime
      from: "unavailable"
    - platform: state
      entity_id: sensor.ha2_uptime
      from: "unavailable"
    - platform: state
      entity_id: sensor.has_uptime
      from: "unavailable"
    - platform: state
      entity_id: sensor.ha_fazenda_uptime
      from: "unavailable"
#    - platform: state
#      entity_id: sensor.ha_off_uptime
#      from: "unavailable"
  action:
    - service: notify.send_message
      data:
        entity_id: notify.telegram_vtel
        message: "\U00002705 {{ states.sensor.date_time.state }} | {{ state_attr(trigger.entity_id, 'friendly_name') | replace(' Uptime', '') if trigger.entity_id is defined else 'Test' }} is now working"

